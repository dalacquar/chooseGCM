<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>chooseGCM: A package for selecting General Circulation Models for Species Distribution Modeling in R • chooseGCM</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="chooseGCM: A package for selecting General Circulation Models for Species Distribution Modeling in R">
<meta name="description" content="This package is intended to help modelers to select General Circulation Models (GCMs) to project Species Distribution Models to future scenarios. The package uses clusterization to detect GCMs that are more different from one another, avoiding highly correlated GCMs.">
<meta property="og:description" content="This package is intended to help modelers to select General Circulation Models (GCMs) to project Species Distribution Models to future scenarios. The package uses clusterization to detect GCMs that are more different from one another, avoiding highly correlated GCMs.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">chooseGCM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="choosegcm-an-r-package-with-a-toolkit-to-select-general-circulation-models">chooseGCM: an R package with a toolkit to select General Circulation Models<a class="anchor" aria-label="anchor" href="#choosegcm-an-r-package-with-a-toolkit-to-select-general-circulation-models"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The goal of chooseGCM is to help researchers aiming to project Species Distribution Models and Ecological Niche Models to future scenarios by applying a selection routine to the General Circulation Models.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of chooseGCM from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"luizesser/chooseGCM"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="tutorial">Tutorial<a class="anchor" aria-label="anchor" href="#tutorial"></a>
</h2>
<p>This is a basic tutorial which shows you how to use the functions in chooseGCM. After installing the package, we need to open it:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://luizesser.github.io/chooseGCM/">chooseGCM</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'dplyr::union' by 'raster::union' when</span></span>
<span><span class="co">#&gt; loading 'chooseGCM'</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'dplyr::intersect' by 'raster::intersect'</span></span>
<span><span class="co">#&gt; when loading 'chooseGCM'</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'ggpubr::rotate' by 'raster::rotate' when</span></span>
<span><span class="co">#&gt; loading 'chooseGCM'</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'dplyr::select' by 'raster::select' when</span></span>
<span><span class="co">#&gt; loading 'chooseGCM'</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'raster::predict' by 'stats::predict' when</span></span>
<span><span class="co">#&gt; loading 'chooseGCM'</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'dplyr::lag' by 'stats::lag' when loading</span></span>
<span><span class="co">#&gt; 'chooseGCM'</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'raster::quantile' by 'stats::quantile' when</span></span>
<span><span class="co">#&gt; loading 'chooseGCM'</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'dplyr::filter' by 'stats::filter' when</span></span>
<span><span class="co">#&gt; loading 'chooseGCM'</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'raster::aggregate' by 'stats::aggregate'</span></span>
<span><span class="co">#&gt; when loading 'chooseGCM'</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'raster::weighted.mean' by</span></span>
<span><span class="co">#&gt; 'stats::weighted.mean' when loading 'chooseGCM'</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'raster::density' by 'stats::density' when</span></span>
<span><span class="co">#&gt; loading 'chooseGCM'</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'raster::update' by 'stats::update' when</span></span>
<span><span class="co">#&gt; loading 'chooseGCM'</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'raster::tail' by 'utils::tail' when loading</span></span>
<span><span class="co">#&gt; 'chooseGCM'</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'raster::stack' by 'utils::stack' when</span></span>
<span><span class="co">#&gt; loading 'chooseGCM'</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'raster::head' by 'utils::head' when loading</span></span>
<span><span class="co">#&gt; 'chooseGCM'</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'raster::unstack' by 'utils::unstack' when</span></span>
<span><span class="co">#&gt; loading 'chooseGCM'</span></span></code></pre></div>
<div class="section level3">
<h3 id="downloading-worldclim-21-data">Downloading WorldClim 2.1 Data<a class="anchor" aria-label="anchor" href="#downloading-worldclim-21-data"></a>
</h3>
<p>First, we need to use only one time period. Here we use 2090 so the difference between models is more conspicuous. In the same way we are considering the SSP585, which is the more dramatic pathway. The resolution is the lowest to be quicker. The aim here is to maintain all parameters equal, but General Circulation Models (GCMs). In this way we know that the only source of variation comes from them. Note that if you receive a timeout error you can increase timeout value by running , where 600 is the value in seconds that will be enough to download the data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">WorldClim_data</span><span class="op">(</span>period <span class="op">=</span> <span class="st">"future"</span>, variable <span class="op">=</span> <span class="st">"bioc"</span>, year <span class="op">=</span> <span class="st">"2090"</span>, gcm <span class="op">=</span> <span class="st">"all"</span>, ssp <span class="op">=</span> <span class="st">"585"</span>, resolution <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="importing-and-transforming-data">Importing and Transforming Data<a class="anchor" aria-label="anchor" href="#importing-and-transforming-data"></a>
</h3>
<p>Now let’s import GCMs to R in a list of stacks and name the list with the names of the GCMs.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/import_gcms.html">import_gcms</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"_ssp585_10_2090"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>In each function, data will be transformed. To do that you will always need to provide at least: (1) the list of stacks, (2) the variables you want to use in analysis and (3) the shapefile of your study area. You don’t need to previously mask and subset your data, once the functions will perform this task internally for you. Note that the results from these functions are highly sensitive to variables and to study area. In this sense, the decision on what variables should be considered and what is the study area must be carefully made considering biological aspects of the studied group.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">var_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bio05"</span>, <span class="st">"bio13"</span>, <span class="st">"bio15"</span><span class="op">)</span></span>
<span><span class="va">study_area_parana</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="st">"input_data/PR_UF_2022.shp"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="straigthforward-approach">Straigthforward Approach<a class="anchor" aria-label="anchor" href="#straigthforward-approach"></a>
</h3>
<p>There is the option to run each function in separate to better understand what is happening and to better parameterize each step. However there is a wrapper to help run everything at once and could be an alternative to have a broad perspective. <code><a href="reference/compare_gcms.html">compare_gcms()</a></code> will return a list with a vector called <code>suggested_gcms</code> and a Figure called <code>statistics_gcms</code>. We suggest that this Figure could also be included as it is in supplementary data from studies using this package.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/compare_gcms.html">compare_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The `&lt;scale&gt;` argument of `guides()` cannot be `FALSE`. Use "none" instead as</span></span>
<span><span class="co">#&gt; of ggplot2 3.3.4.</span></span>
<span><span class="co">#&gt; ℹ The deprecated feature was likely used in the factoextra package.</span></span>
<span><span class="co">#&gt;   Please report the issue at &lt;https://github.com/kassambara/factoextra/issues&gt;.</span></span>
<span><span class="co">#&gt; This warning is displayed once every 8 hours.</span></span>
<span><span class="co">#&gt; Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span>
<span><span class="co">#&gt; generated.</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">statistics_gcms</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-9-1.png" width="100%"></p>
<p>The aim of this function is to inform the minimum required so users can follow with their workflow in a more straightforward fashion (more on each plot further). If we see the D plot in the Figure, we can infer if the selected GCMs encompass the environmental variety of all GCMs. The focus should be to cover the core environment and not outlier regions on the environmental space. Above that, in plot B, the Monte Carlo permutation between GCMs is presented as a violin plot. Plots A and C are both clusterization methods that can be used to select GCMs. Clusterization will be adapted to the number of clusters <code>k</code> designated in the function. Lastly, suggested GCMs were “uk”, “ml” and “ac”. Those suggestions are the gcms that are closer to the centroid of each K-means cluster, thus they better represent the variation within each cluster.</p>
</div>
<div class="section level3">
<h3 id="deep-dive-approach">Deep-dive Approach<a class="anchor" aria-label="anchor" href="#deep-dive-approach"></a>
</h3>
<p>As an alternative for experienced modelers that want to deeply understand the impacts of decisions on GCMs selection, we prepared a set of functions to analyze data more carefully. Each function in the wrapper mentioned above is available to be explored as stand-alone, ranging from exploratory analysis to cluster analysis and methods to determine the optimum number of clusters.</p>
<div class="section level4">
<h4 id="exploratory-analysis">Exploratory Analysis<a class="anchor" aria-label="anchor" href="#exploratory-analysis"></a>
</h4>
<p>In chooseGCM we implemented functions to analyze GCMs attributes. <code>summary_gcms</code> is the only function available that describes variations within GCMs. It returns the internal information regarding each variable, as reads: minimum value (min), first quartile (quantile_0.25), second quartile (median), average (mean), third quartile (quantile_0.75), maximum value (max), standard deviation (sd), number of NAs (NAs) and the total number of cells (n_cells). This function returns a list of GCMs with a table associated with each of them.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summary of GCMs</span></span>
<span><span class="va">s_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/summary_gcms.html">summary_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span><span class="op">)</span></span>
<span><span class="va">s_sum</span></span>
<span><span class="co">#&gt; $ac</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  30.26061      33.01390  35.02451  34.80212      36.42513  38.40598</span></span>
<span><span class="co">#&gt; bio13 224.12063     282.74970 313.23091 324.24229     368.32585 442.13201</span></span>
<span><span class="co">#&gt; bio15  21.40317      31.66128  36.05844  35.76401      39.83684  52.37042</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  1.984392 343     975</span></span>
<span><span class="co">#&gt; bio13 49.323508 343     975</span></span>
<span><span class="co">#&gt; bio15  6.124250 343     975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ae</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  28.72171      31.64461  33.82813  33.70744      35.54123  38.52787</span></span>
<span><span class="co">#&gt; bio13 164.11662     206.36238 234.51909 231.88477     253.38022 340.26649</span></span>
<span><span class="co">#&gt; bio15  14.10353      23.27106  26.92607  27.71403      32.05736  48.57550</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  2.341817 343     975</span></span>
<span><span class="co">#&gt; bio13 32.920944 343     975</span></span>
<span><span class="co">#&gt; bio15  6.629614 343     975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ca</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  32.62990      36.49244  39.98461  39.63354      42.59414  45.46806</span></span>
<span><span class="co">#&gt; bio13 134.25184     160.69164 177.39474 180.04803     195.73812 252.99690</span></span>
<span><span class="co">#&gt; bio15  26.38048      35.63326  41.19924  41.31525      46.43239  61.80791</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  3.405290 343     975</span></span>
<span><span class="co">#&gt; bio13 24.086040 343     975</span></span>
<span><span class="co">#&gt; bio15  7.466578 343     975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cc</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  32.86076      36.94869  40.39324  40.11279      43.12089  45.93269</span></span>
<span><span class="co">#&gt; bio13 132.89175     163.38650 175.39422 179.95447     192.31163 249.38172</span></span>
<span><span class="co">#&gt; bio15  26.39760      36.50399  41.36431  41.70356      46.65127  62.98824</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  3.468721 343     975</span></span>
<span><span class="co">#&gt; bio13 22.023718 343     975</span></span>
<span><span class="co">#&gt; bio15  7.492665 343     975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ce</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  28.49086      30.90774  33.32123  33.08078      34.98518  37.23296</span></span>
<span><span class="co">#&gt; bio13 160.09206     188.54479 207.32792 209.78494     226.39106 346.90099</span></span>
<span><span class="co">#&gt; bio15  22.64219      30.51760  34.49656  35.52471      39.34769  59.90047</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  2.303271 343     975</span></span>
<span><span class="co">#&gt; bio13 28.984064 343     975</span></span>
<span><span class="co">#&gt; bio15  7.128410 343     975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ch</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  30.29526      32.71605  35.01514  34.73141      36.57695  38.06917</span></span>
<span><span class="co">#&gt; bio13 161.80281     198.74798 226.59591 233.75398     262.41017 332.11823</span></span>
<span><span class="co">#&gt; bio15  22.31555      29.53830  33.89825  33.87370      37.33222  49.77581</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  2.159323 343     975</span></span>
<span><span class="co">#&gt; bio13 41.414470 343     975</span></span>
<span><span class="co">#&gt; bio15  5.503135 343     975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cn</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  29.83416      32.23992  34.13371  33.98563       35.6433  37.27494</span></span>
<span><span class="co">#&gt; bio13 163.08033     203.04138 231.56849 243.36138      282.9891 360.52124</span></span>
<span><span class="co">#&gt; bio15  21.91490      29.17356  33.61836  33.57262       37.3163  48.95621</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  1.940772 343     975</span></span>
<span><span class="co">#&gt; bio13 49.210449 343     975</span></span>
<span><span class="co">#&gt; bio15  5.383665 343     975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cr</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  29.73416      32.12476  33.76563  33.70309      35.23139  37.00658</span></span>
<span><span class="co">#&gt; bio13 165.68021     198.03851 224.10872 229.39616     257.07826 319.60043</span></span>
<span><span class="co">#&gt; bio15  18.27380      27.51016  32.76278  32.90503      37.67608  50.93997</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  1.800216 343     975</span></span>
<span><span class="co">#&gt; bio13 37.532586 343     975</span></span>
<span><span class="co">#&gt; bio15  6.818873 343     975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ec</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  28.05644      30.52174  33.39316  33.62745      36.40044  40.06277</span></span>
<span><span class="co">#&gt; bio13 153.43311     191.60708 220.34475 222.27008     248.99831 323.45767</span></span>
<span><span class="co">#&gt; bio15  23.85794      29.93092  32.78896  33.47820      37.01114  47.53911</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  3.256466 343     975</span></span>
<span><span class="co">#&gt; bio13 36.560327 343     975</span></span>
<span><span class="co">#&gt; bio15  4.603615 343     975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ev</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  28.29086      30.87917  34.06034  34.08671      36.90689  40.53250</span></span>
<span><span class="co">#&gt; bio13 145.59344     180.00812 201.42543 207.51134     230.57723 334.26770</span></span>
<span><span class="co">#&gt; bio15  24.86201      30.28744  33.70015  34.34216      37.43661  50.58348</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  3.359603 343     975</span></span>
<span><span class="co">#&gt; bio13 35.548106 343     975</span></span>
<span><span class="co">#&gt; bio15  4.857611 343     975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fi</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  29.01210      31.84949  33.83313  33.64331      35.26741  37.84391</span></span>
<span><span class="co">#&gt; bio13 174.65593     201.64553 219.94507 225.18894     251.17838 314.61781</span></span>
<span><span class="co">#&gt; bio15  19.08621      25.87605  29.58721  30.32712      33.61018  51.10931</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  2.023927 343     975</span></span>
<span><span class="co">#&gt; bio13 30.105078 343     975</span></span>
<span><span class="co">#&gt; bio15  6.063165 343     975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $gg</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  28.35196      30.77980  32.79452  32.60924      34.28063  36.15628</span></span>
<span><span class="co">#&gt; bio13 153.75514     176.61163 196.54703 196.33973     212.15815 296.91739</span></span>
<span><span class="co">#&gt; bio15  11.78741      19.03363  22.44540  23.67124      27.45332  45.49844</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  2.004696 343     975</span></span>
<span><span class="co">#&gt; bio13 23.249518 343     975</span></span>
<span><span class="co">#&gt; bio15  6.517065 343     975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $gh</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  28.21731      30.68337  32.73374  32.60451      34.37039  36.18172</span></span>
<span><span class="co">#&gt; bio13 147.10829     181.80839 208.58071 209.69143     237.33228 282.34803</span></span>
<span><span class="co">#&gt; bio15  19.85593      25.70747  28.00496  29.27738      32.68606  48.97674</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  2.117708 343     975</span></span>
<span><span class="co">#&gt; bio13 30.789909 343     975</span></span>
<span><span class="co">#&gt; bio15  5.440492 343     975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $hg</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  31.13856      34.42890  36.70430  36.47516      38.43256  40.57494</span></span>
<span><span class="co">#&gt; bio13 169.04159     213.45747 236.87317 244.27400     275.88901 354.59307</span></span>
<span><span class="co">#&gt; bio15  15.53709      23.15852  27.00961  27.76471      31.46548  46.62684</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  2.310044 343     975</span></span>
<span><span class="co">#&gt; bio13 40.251235 343     975</span></span>
<span><span class="co">#&gt; bio15  6.005802 343     975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ic</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  28.70776      30.79083  32.44845  32.34917      33.80908  35.87494</span></span>
<span><span class="co">#&gt; bio13 147.30466     171.06382 186.87254 193.35761     212.68533 288.32870</span></span>
<span><span class="co">#&gt; bio15  14.58007      24.16027  27.83976  28.68280      32.59996  49.03214</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  1.811552 343     975</span></span>
<span><span class="co">#&gt; bio13 28.012579 343     975</span></span>
<span><span class="co">#&gt; bio15  6.635170 343     975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`in`</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  28.72848      30.82765  32.41980  32.40730      33.80212  36.47494</span></span>
<span><span class="co">#&gt; bio13 161.52419     185.46827 199.54241 202.64082     214.50042 351.75621</span></span>
<span><span class="co">#&gt; bio15  14.65916      23.77119  27.98068  28.64915      32.95829  50.70791</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  1.830847 343     975</span></span>
<span><span class="co">#&gt; bio13 24.217670 343     975</span></span>
<span><span class="co">#&gt; bio15  7.375416 343     975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ip</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  29.73416      32.68782  35.77748  35.48970      37.91489  40.41699</span></span>
<span><span class="co">#&gt; bio13 159.56344     181.32766 195.05749 197.40103     211.32161 284.26690</span></span>
<span><span class="co">#&gt; bio15  16.00507      26.77708  32.80609  33.31139      39.05771  60.27994</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  2.901743 343     975</span></span>
<span><span class="co">#&gt; bio13 20.271548 343     975</span></span>
<span><span class="co">#&gt; bio15  9.020713 343     975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $me</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  27.62848      29.58797  31.27632  31.26874      32.73183  34.80598</span></span>
<span><span class="co">#&gt; bio13 156.52474     179.48378 199.96653 204.79726     226.42528 297.73651</span></span>
<span><span class="co">#&gt; bio15  16.15398      26.19266  28.80313  29.72263      33.38585  49.10374</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  1.837425 343     975</span></span>
<span><span class="co">#&gt; bio13 29.107648 343     975</span></span>
<span><span class="co">#&gt; bio15  6.231605 343     975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mi</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  29.78985      32.06696  32.97152  33.02705      34.02152  36.42464</span></span>
<span><span class="co">#&gt; bio13 161.00713     191.65730 209.20822 215.86132     239.70697 307.64819</span></span>
<span><span class="co">#&gt; bio15  16.95916      26.03894  29.28605  29.57971      32.96107  43.80171</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  1.402383 343     975</span></span>
<span><span class="co">#&gt; bio13 29.770515 343     975</span></span>
<span><span class="co">#&gt; bio15  5.266897 343     975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ml</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  28.50776      30.50234  32.24707  32.18487      33.70495  36.34391</span></span>
<span><span class="co">#&gt; bio13 148.63551     173.25150 188.91330 189.76359     202.15102 312.62540</span></span>
<span><span class="co">#&gt; bio15  18.31306      28.64226  32.92004  34.05128      39.09806  57.43911</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  1.888484 343     975</span></span>
<span><span class="co">#&gt; bio13 23.275037 343     975</span></span>
<span><span class="co">#&gt; bio15  8.098461 343     975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mp</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  28.37438      30.29746  31.96719  31.93173      33.45840  35.55591</span></span>
<span><span class="co">#&gt; bio13 156.99983     190.47906 208.26453 210.06902     228.44029 301.85869</span></span>
<span><span class="co">#&gt; bio15  15.56945      25.51134  29.19092  30.75855      35.40487  52.80058</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  1.866198 343     975</span></span>
<span><span class="co">#&gt; bio13 27.141968 343     975</span></span>
<span><span class="co">#&gt; bio15  7.543110 343     975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mr</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  28.09086      30.35537  32.03033  31.89886      33.33648  35.64391</span></span>
<span><span class="co">#&gt; bio13 168.56911     211.65106 243.65130 245.46815     277.43495 325.04975</span></span>
<span><span class="co">#&gt; bio15  19.00734      26.82087  32.25545  32.05659      36.88110  50.29647</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  1.751161 343     975</span></span>
<span><span class="co">#&gt; bio13 37.353812 343     975</span></span>
<span><span class="co">#&gt; bio15  6.804995 343     975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $uk</span></span>
<span><span class="co">#&gt;             min quantile_0.25    median      mean quantile_0.75       max</span></span>
<span><span class="co">#&gt; bio05  31.22171      34.10035  36.20007  36.21587      38.23228  41.14654</span></span>
<span><span class="co">#&gt; bio13 157.72174     200.08367 228.58700 234.20227     265.91798 350.73710</span></span>
<span><span class="co">#&gt; bio15  17.88849      25.91104  30.26981  30.59170      34.71065  47.98321</span></span>
<span><span class="co">#&gt;              sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio05  2.404882 343     975</span></span>
<span><span class="co">#&gt; bio13 42.730072 343     975</span></span>
<span><span class="co">#&gt; bio15  6.175806 343     975</span></span></code></pre></div>
<p>Regarding the exploratory comparison between GCMs, two functions are available: <code>cor_gcms</code> and <code>dist_gcms</code>. The first is designed to return a list with a correlation matrix between GCMs and a plot of this matrix. We noticed while building this package that (as expected) Pearson correlation values are always very high, rarely reaching values bellow 0.95. In this way we found that this function could not be so informative and decided to present a distance function as seen bellow. However it is noteworthy that through this function the user can change the method used to obtain correlation values. See <code><a href="reference/cor_gcms.html">?cor_gcms</a></code> for available methods.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pearson Correlation between GCMs</span></span>
<span><span class="va">s_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cor_gcms.html">cor_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span>
<span><span class="va">s_cor</span></span>
<span><span class="co">#&gt; $cor_matrix</span></span>
<span><span class="co">#&gt;           ac        ae        ca        cc        ce        ch        cn</span></span>
<span><span class="co">#&gt; ac 1.0000000 0.8168457 0.7377052 0.7699584 0.7123809 0.9260965 0.9730326</span></span>
<span><span class="co">#&gt; ae 0.8168457 1.0000000 0.9111641 0.8701274 0.9087373 0.8950387 0.8602279</span></span>
<span><span class="co">#&gt; ca 0.7377052 0.9111641 1.0000000 0.9529991 0.9185688 0.8071467 0.7644214</span></span>
<span><span class="co">#&gt; cc 0.7699584 0.8701274 0.9529991 1.0000000 0.8795839 0.8179988 0.7960723</span></span>
<span><span class="co">#&gt; ce 0.7123809 0.9087373 0.9185688 0.8795839 1.0000000 0.8352246 0.7633085</span></span>
<span><span class="co">#&gt; ch 0.9260965 0.8950387 0.8071467 0.8179988 0.8352246 1.0000000 0.9456752</span></span>
<span><span class="co">#&gt; cn 0.9730326 0.8602279 0.7644214 0.7960723 0.7633085 0.9456752 1.0000000</span></span>
<span><span class="co">#&gt; cr 0.9698425 0.8823095 0.8092755 0.8345769 0.7987614 0.9625161 0.9819558</span></span>
<span><span class="co">#&gt; ec 0.8422210 0.9178961 0.8103145 0.7971072 0.8113835 0.9032865 0.8776732</span></span>
<span><span class="co">#&gt; ev 0.8296694 0.9118506 0.8285572 0.8262468 0.8468423 0.9095587 0.8815798</span></span>
<span><span class="co">#&gt; fi 0.8586389 0.9217809 0.8727985 0.8661485 0.9061916 0.9096782 0.8969811</span></span>
<span><span class="co">#&gt; gg 0.8331262 0.9482198 0.8916034 0.8725616 0.9269122 0.8965138 0.8707006</span></span>
<span><span class="co">#&gt; gh 0.9083067 0.8235925 0.7446238 0.7655103 0.7284009 0.8769268 0.9105517</span></span>
<span><span class="co">#&gt; hg 0.8841268 0.9300254 0.8297376 0.8188666 0.8283096 0.9128693 0.9092986</span></span>
<span><span class="co">#&gt; ic 0.8998764 0.9209997 0.8800967 0.8789368 0.8799301 0.9481856 0.9259315</span></span>
<span><span class="co">#&gt; in 0.7170504 0.8942162 0.8614722 0.8742621 0.9051239 0.8129592 0.7650999</span></span>
<span><span class="co">#&gt; ip 0.6660920 0.8976136 0.9467857 0.9233185 0.9033274 0.7492696 0.6969025</span></span>
<span><span class="co">#&gt; me 0.8851458 0.9325317 0.8735989 0.8662006 0.8753405 0.9330303 0.9160118</span></span>
<span><span class="co">#&gt; mi 0.9316105 0.8946993 0.8115822 0.8254643 0.8139785 0.9415960 0.9401168</span></span>
<span><span class="co">#&gt; ml 0.7721328 0.9334139 0.9026873 0.8803522 0.9374324 0.8524023 0.8106532</span></span>
<span><span class="co">#&gt; mp 0.7888471 0.9486767 0.9236568 0.8726720 0.9367250 0.8627422 0.8257242</span></span>
<span><span class="co">#&gt; mr 0.9797531 0.7786801 0.7106341 0.7524977 0.6807161 0.9101279 0.9536606</span></span>
<span><span class="co">#&gt; uk 0.8685524 0.9426546 0.8601004 0.8417883 0.8437744 0.9204922 0.8997568</span></span>
<span><span class="co">#&gt;           cr        ec        ev        fi        gg        gh        hg</span></span>
<span><span class="co">#&gt; ac 0.9698425 0.8422210 0.8296694 0.8586389 0.8331262 0.9083067 0.8841268</span></span>
<span><span class="co">#&gt; ae 0.8823095 0.9178961 0.9118506 0.9217809 0.9482198 0.8235925 0.9300254</span></span>
<span><span class="co">#&gt; ca 0.8092755 0.8103145 0.8285572 0.8727985 0.8916034 0.7446238 0.8297376</span></span>
<span><span class="co">#&gt; cc 0.8345769 0.7971072 0.8262468 0.8661485 0.8725616 0.7655103 0.8188666</span></span>
<span><span class="co">#&gt; ce 0.7987614 0.8113835 0.8468423 0.9061916 0.9269122 0.7284009 0.8283096</span></span>
<span><span class="co">#&gt; ch 0.9625161 0.9032865 0.9095587 0.9096782 0.8965138 0.8769268 0.9128693</span></span>
<span><span class="co">#&gt; cn 0.9819558 0.8776732 0.8815798 0.8969811 0.8707006 0.9105517 0.9092986</span></span>
<span><span class="co">#&gt; cr 1.0000000 0.8804530 0.8794786 0.9118943 0.9074008 0.9163500 0.9164136</span></span>
<span><span class="co">#&gt; ec 0.8804530 1.0000000 0.9769926 0.8907992 0.8628081 0.8313826 0.9417478</span></span>
<span><span class="co">#&gt; ev 0.8794786 0.9769926 1.0000000 0.9126548 0.8781098 0.8151110 0.9467112</span></span>
<span><span class="co">#&gt; fi 0.9118943 0.8907992 0.9126548 1.0000000 0.9538430 0.8706235 0.9527152</span></span>
<span><span class="co">#&gt; gg 0.9074008 0.8628081 0.8781098 0.9538430 1.0000000 0.8754215 0.9113567</span></span>
<span><span class="co">#&gt; gh 0.9163500 0.8313826 0.8151110 0.8706235 0.8754215 1.0000000 0.8670281</span></span>
<span><span class="co">#&gt; hg 0.9164136 0.9417478 0.9467112 0.9527152 0.9113567 0.8670281 1.0000000</span></span>
<span><span class="co">#&gt; ic 0.9544140 0.8542169 0.8733282 0.9321585 0.9472424 0.8615123 0.9096903</span></span>
<span><span class="co">#&gt; in 0.8086542 0.7657924 0.7981165 0.8842709 0.9293609 0.7204413 0.8320453</span></span>
<span><span class="co">#&gt; ip 0.7523479 0.7665815 0.7850480 0.8305166 0.8896283 0.7092065 0.7856322</span></span>
<span><span class="co">#&gt; me 0.9437898 0.8564719 0.8675465 0.9282559 0.9565043 0.8706964 0.9122721</span></span>
<span><span class="co">#&gt; mi 0.9680010 0.8700903 0.8720177 0.9161966 0.9222395 0.8720106 0.9228911</span></span>
<span><span class="co">#&gt; ml 0.8535342 0.8203916 0.8476937 0.9307982 0.9685639 0.8027943 0.8792123</span></span>
<span><span class="co">#&gt; mp 0.8553100 0.8362250 0.8552786 0.9428780 0.9497788 0.8110272 0.8935274</span></span>
<span><span class="co">#&gt; mr 0.9640562 0.8095983 0.7981135 0.8410090 0.8210487 0.9288927 0.8555727</span></span>
<span><span class="co">#&gt; uk 0.9139330 0.9531678 0.9622447 0.9360413 0.9068641 0.8348837 0.9845585</span></span>
<span><span class="co">#&gt;           ic        in        ip        me        mi        ml        mp</span></span>
<span><span class="co">#&gt; ac 0.8998764 0.7170504 0.6660920 0.8851458 0.9316105 0.7721328 0.7888471</span></span>
<span><span class="co">#&gt; ae 0.9209997 0.8942162 0.8976136 0.9325317 0.8946993 0.9334139 0.9486767</span></span>
<span><span class="co">#&gt; ca 0.8800967 0.8614722 0.9467857 0.8735989 0.8115822 0.9026873 0.9236568</span></span>
<span><span class="co">#&gt; cc 0.8789368 0.8742621 0.9233185 0.8662006 0.8254643 0.8803522 0.8726720</span></span>
<span><span class="co">#&gt; ce 0.8799301 0.9051239 0.9033274 0.8753405 0.8139785 0.9374324 0.9367250</span></span>
<span><span class="co">#&gt; ch 0.9481856 0.8129592 0.7492696 0.9330303 0.9415960 0.8524023 0.8627422</span></span>
<span><span class="co">#&gt; cn 0.9259315 0.7650999 0.6969025 0.9160118 0.9401168 0.8106532 0.8257242</span></span>
<span><span class="co">#&gt; cr 0.9544140 0.8086542 0.7523479 0.9437898 0.9680010 0.8535342 0.8553100</span></span>
<span><span class="co">#&gt; ec 0.8542169 0.7657924 0.7665815 0.8564719 0.8700903 0.8203916 0.8362250</span></span>
<span><span class="co">#&gt; ev 0.8733282 0.7981165 0.7850480 0.8675465 0.8720177 0.8476937 0.8552786</span></span>
<span><span class="co">#&gt; fi 0.9321585 0.8842709 0.8305166 0.9282559 0.9161966 0.9307982 0.9428780</span></span>
<span><span class="co">#&gt; gg 0.9472424 0.9293609 0.8896283 0.9565043 0.9222395 0.9685639 0.9497788</span></span>
<span><span class="co">#&gt; gh 0.8615123 0.7204413 0.7092065 0.8706964 0.8720106 0.8027943 0.8110272</span></span>
<span><span class="co">#&gt; hg 0.9096903 0.8320453 0.7856322 0.9122721 0.9228911 0.8792123 0.8935274</span></span>
<span><span class="co">#&gt; ic 1.0000000 0.9026653 0.8307098 0.9895197 0.9666579 0.9193685 0.9174823</span></span>
<span><span class="co">#&gt; in 0.9026653 1.0000000 0.9034021 0.9105777 0.8679108 0.9562031 0.9111128</span></span>
<span><span class="co">#&gt; ip 0.8307098 0.9034021 1.0000000 0.8359167 0.7699188 0.9195820 0.9023435</span></span>
<span><span class="co">#&gt; me 0.9895197 0.9105777 0.8359167 1.0000000 0.9648281 0.9309497 0.9236060</span></span>
<span><span class="co">#&gt; mi 0.9666579 0.8679108 0.7699188 0.9648281 1.0000000 0.8895426 0.8761040</span></span>
<span><span class="co">#&gt; ml 0.9193685 0.9562031 0.9195820 0.9309497 0.8895426 1.0000000 0.9720941</span></span>
<span><span class="co">#&gt; mp 0.9174823 0.9111128 0.9023435 0.9236060 0.8761040 0.9720941 1.0000000</span></span>
<span><span class="co">#&gt; mr 0.8838154 0.7006355 0.6548661 0.8648326 0.9171438 0.7586856 0.7646548</span></span>
<span><span class="co">#&gt; uk 0.9210851 0.8390862 0.8073069 0.9226813 0.9231350 0.8840019 0.8962334</span></span>
<span><span class="co">#&gt;           mr        uk</span></span>
<span><span class="co">#&gt; ac 0.9797531 0.8685524</span></span>
<span><span class="co">#&gt; ae 0.7786801 0.9426546</span></span>
<span><span class="co">#&gt; ca 0.7106341 0.8601004</span></span>
<span><span class="co">#&gt; cc 0.7524977 0.8417883</span></span>
<span><span class="co">#&gt; ce 0.6807161 0.8437744</span></span>
<span><span class="co">#&gt; ch 0.9101279 0.9204922</span></span>
<span><span class="co">#&gt; cn 0.9536606 0.8997568</span></span>
<span><span class="co">#&gt; cr 0.9640562 0.9139330</span></span>
<span><span class="co">#&gt; ec 0.8095983 0.9531678</span></span>
<span><span class="co">#&gt; ev 0.7981135 0.9622447</span></span>
<span><span class="co">#&gt; fi 0.8410090 0.9360413</span></span>
<span><span class="co">#&gt; gg 0.8210487 0.9068641</span></span>
<span><span class="co">#&gt; gh 0.9288927 0.8348837</span></span>
<span><span class="co">#&gt; hg 0.8555727 0.9845585</span></span>
<span><span class="co">#&gt; ic 0.8838154 0.9210851</span></span>
<span><span class="co">#&gt; in 0.7006355 0.8390862</span></span>
<span><span class="co">#&gt; ip 0.6548661 0.8073069</span></span>
<span><span class="co">#&gt; me 0.8648326 0.9226813</span></span>
<span><span class="co">#&gt; mi 0.9171438 0.9231350</span></span>
<span><span class="co">#&gt; ml 0.7586856 0.8840019</span></span>
<span><span class="co">#&gt; mp 0.7646548 0.8962334</span></span>
<span><span class="co">#&gt; mr 1.0000000 0.8359830</span></span>
<span><span class="co">#&gt; uk 0.8359830 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cor_plot</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-11-1.png" width="100%"></p>
<p>The function <code>dist_gcms</code> is very similar to the previous <code>cor_gcms</code>, but now for distances. This function has the same output: a list with two slots. One is the distance matrix obtained (<code>distances</code>), while the second is the plotted matrix (<code>heatmap</code>). Here the differences between GCMs are way more clear than in the previous plot. As in was it the previous function, methods can also be changed for a number of different distances. For a complete list of available methods see <code><a href="reference/dist_gcms.html">?dist_gcms</a></code>. To build a distance matrix considering multiple variables to each GCM we use a flattening strategy, where values are concatenated in one unique vector to each GCM. In the process, we need to scale variables so they end up with the same measure. This matrix is also used to calculate the clusters in the <code>compare_gcms</code> function and in further presented <code>kmeans_gcms</code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Euclidean Distance between GCMs</span></span>
<span><span class="va">s_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dist_gcms.html">dist_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span></span>
<span><span class="va">s_dist</span></span>
<span><span class="co">#&gt; $distances</span></span>
<span><span class="co">#&gt;           ac        ae        ca        cc        ce        ch        cn</span></span>
<span><span class="co">#&gt; ae 32.707143                                                            </span></span>
<span><span class="co">#&gt; ca 39.140733 22.778667                                                  </span></span>
<span><span class="co">#&gt; cc 36.655338 27.541831 16.568653                                        </span></span>
<span><span class="co">#&gt; ce 40.986695 23.087698 21.808682 26.520177                              </span></span>
<span><span class="co">#&gt; ch 20.776218 24.759889 33.561982 32.604027 31.022743                    </span></span>
<span><span class="co">#&gt; cn 12.550275 28.572241 37.093854 34.512167 37.181369 17.812842          </span></span>
<span><span class="co">#&gt; cr 13.271861 26.218311 33.376232 31.083663 34.283861 14.796420 10.266041</span></span>
<span><span class="co">#&gt; ec 30.356987 21.898581 33.285196 34.424478 33.191273 23.767179 26.729749</span></span>
<span><span class="co">#&gt; ev 31.541357 22.690485 31.644171 31.856679 29.909107 22.983571 26.299469</span></span>
<span><span class="co">#&gt; fi 28.734191 21.374236 27.257134 27.960549 23.407494 22.968385 24.529719</span></span>
<span><span class="co">#&gt; gg 31.219657 17.390653 25.161810 27.282500 20.661243 24.585292 27.480983</span></span>
<span><span class="co">#&gt; gh 23.142104 32.099077 38.621068 37.008030 39.828890 26.811169 22.857050</span></span>
<span><span class="co">#&gt; hg 26.015100 20.216424 31.535047 32.526201 31.667009 22.558990 23.016600</span></span>
<span><span class="co">#&gt; ic 24.182563 21.480697 26.463647 26.591332 26.482020 17.396390 20.799399</span></span>
<span><span class="co">#&gt; in 40.652630 24.856716 28.444774 27.099869 23.540331 33.052339 37.040401</span></span>
<span><span class="co">#&gt; ip 44.161876 24.454303 17.629827 21.163098 23.762147 38.268161 42.075108</span></span>
<span><span class="co">#&gt; me 25.900459 19.851066 27.171245 27.955108 26.983401 19.777581 22.148444</span></span>
<span><span class="co">#&gt; mi 19.986133 24.799888 33.173783 31.928332 32.962154 18.469508 18.701929</span></span>
<span><span class="co">#&gt; ml 36.481694 19.720864 23.840688 26.435429 19.116512 29.361207 33.255472</span></span>
<span><span class="co">#&gt; mp 35.118232 17.313755 21.116365 27.270680 19.224281 28.314093 31.904550</span></span>
<span><span class="co">#&gt; mr 10.874614 35.953761 41.110974 38.021017 43.183969 22.911124 16.451637</span></span>
<span><span class="co">#&gt; uk 27.708338 18.301361 28.585272 30.398584 30.207183 21.549593 24.197000</span></span>
<span><span class="co">#&gt;           cr        ec        ev        fi        gg        gh        hg</span></span>
<span><span class="co">#&gt; ae                                                                      </span></span>
<span><span class="co">#&gt; ca                                                                      </span></span>
<span><span class="co">#&gt; cc                                                                      </span></span>
<span><span class="co">#&gt; ce                                                                      </span></span>
<span><span class="co">#&gt; ch                                                                      </span></span>
<span><span class="co">#&gt; cn                                                                      </span></span>
<span><span class="co">#&gt; cr                                                                      </span></span>
<span><span class="co">#&gt; ec 26.424293                                                            </span></span>
<span><span class="co">#&gt; ev 26.531761 11.592261                                                  </span></span>
<span><span class="co">#&gt; fi 22.684854 25.254976 22.586742                                        </span></span>
<span><span class="co">#&gt; gg 23.256148 28.307286 26.682004 16.419229                              </span></span>
<span><span class="co">#&gt; gh 22.103808 31.382339 32.861665 27.489182 26.974635                    </span></span>
<span><span class="co">#&gt; hg 22.095405 18.445491 17.642174 16.618616 22.753968 27.868529          </span></span>
<span><span class="co">#&gt; ic 16.317359 29.180164 27.200317 19.905906 17.554017 28.440657 22.966844</span></span>
<span><span class="co">#&gt; in 33.430555 36.985765 34.338754 25.998918 20.312187 40.408297 31.320608</span></span>
<span><span class="co">#&gt; ip 38.032516 36.923401 35.432744 31.462823 25.390012 41.212262 35.384566</span></span>
<span><span class="co">#&gt; me 18.119307 28.953603 27.814148 20.470443 15.938862 27.481428 22.636169</span></span>
<span><span class="co">#&gt; mi 13.671067 27.545767 27.340666 22.124063 21.311478 27.341426 21.221997</span></span>
<span><span class="co">#&gt; ml 29.248404 32.388987 29.825864 20.104477 13.550292 33.938592 26.561064</span></span>
<span><span class="co">#&gt; mp 29.070560 30.928430 29.073712 18.265674 17.126848 33.222605 24.937510</span></span>
<span><span class="co">#&gt; mr 14.489262 33.347980 34.339007 30.473361 32.329691 20.379388 29.044149</span></span>
<span><span class="co">#&gt; uk 22.420862 16.538897 14.849889 19.327865 23.323446 31.054825  9.496830</span></span>
<span><span class="co">#&gt;           ic        in        ip        me        mi        ml        mp</span></span>
<span><span class="co">#&gt; ae                                                                      </span></span>
<span><span class="co">#&gt; ca                                                                      </span></span>
<span><span class="co">#&gt; cc                                                                      </span></span>
<span><span class="co">#&gt; ce                                                                      </span></span>
<span><span class="co">#&gt; ch                                                                      </span></span>
<span><span class="co">#&gt; cn                                                                      </span></span>
<span><span class="co">#&gt; cr                                                                      </span></span>
<span><span class="co">#&gt; ec                                                                      </span></span>
<span><span class="co">#&gt; ev                                                                      </span></span>
<span><span class="co">#&gt; fi                                                                      </span></span>
<span><span class="co">#&gt; gg                                                                      </span></span>
<span><span class="co">#&gt; gh                                                                      </span></span>
<span><span class="co">#&gt; hg                                                                      </span></span>
<span><span class="co">#&gt; ic                                                                      </span></span>
<span><span class="co">#&gt; in 23.843387                                                            </span></span>
<span><span class="co">#&gt; ip 31.444883 23.752966                                                  </span></span>
<span><span class="co">#&gt; me  7.823842 22.853730 30.957526                                        </span></span>
<span><span class="co">#&gt; mi 13.955031 27.775869 36.658497 14.332823                              </span></span>
<span><span class="co">#&gt; ml 21.701338 15.993958 21.672581 20.082460 25.399872                    </span></span>
<span><span class="co">#&gt; mp 21.953689 22.785241 23.882772 21.123389 26.900647 12.766792          </span></span>
<span><span class="co">#&gt; mr 26.050032 41.815202 44.898091 28.097650 21.998679 37.542716 37.075480</span></span>
<span><span class="co">#&gt; uk 21.469092 30.657076 33.548042 21.250854 21.188415 26.029118 24.618572</span></span>
<span><span class="co">#&gt;           mr</span></span>
<span><span class="co">#&gt; ae          </span></span>
<span><span class="co">#&gt; ca          </span></span>
<span><span class="co">#&gt; cc          </span></span>
<span><span class="co">#&gt; ce          </span></span>
<span><span class="co">#&gt; ch          </span></span>
<span><span class="co">#&gt; cn          </span></span>
<span><span class="co">#&gt; cr          </span></span>
<span><span class="co">#&gt; ec          </span></span>
<span><span class="co">#&gt; ev          </span></span>
<span><span class="co">#&gt; fi          </span></span>
<span><span class="co">#&gt; gg          </span></span>
<span><span class="co">#&gt; gh          </span></span>
<span><span class="co">#&gt; hg          </span></span>
<span><span class="co">#&gt; ic          </span></span>
<span><span class="co">#&gt; in          </span></span>
<span><span class="co">#&gt; ip          </span></span>
<span><span class="co">#&gt; me          </span></span>
<span><span class="co">#&gt; mi          </span></span>
<span><span class="co">#&gt; ml          </span></span>
<span><span class="co">#&gt; mp          </span></span>
<span><span class="co">#&gt; mr          </span></span>
<span><span class="co">#&gt; uk 30.951276</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $heatmap</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-12-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="obtain-clusters">Obtain Clusters<a class="anchor" aria-label="anchor" href="#obtain-clusters"></a>
</h4>
<p>Clusters in chooseGCM are obtained through K-means, a unsupervised machine learning algorithm. K in this case is the number of GCMs the modeler wants to use in projections. As in the previous <code>dist_gcms</code> function, we can address different methods to obtain the distance matrix by changing the <code>method</code> argument. The K-means algorithm uses the distance matrix to obtain clusters, thus a deep analysis of distances using <code>dist_gcms</code> function could prove to be useful. As in <code>compare_gcms</code> function, this function returns the K-means plot and a set of suggested GCMs, i.e. the GCMs closer to the centroid of each clusters.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/kmeans_gcms.html">kmeans_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, k <span class="op">=</span> <span class="fl">3</span>, method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $suggested_gcms</span></span>
<span><span class="co">#&gt;    1    2    3 </span></span>
<span><span class="co">#&gt; "uk" "ac" "ml" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $kmeans_plot</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-13-1.png" width="100%"></p>
<p>Alternatively, instead of using distances, one could run the analysis with raw environmental data by not setting any value to method (note how axis change). As in the previous case, the function also returns GCMs that are closer to the centroids. Note however that the plot below has a cluster with two GCMs, thus both have the same distance from the centroid. In this case, the function randomly suggests one of them. To perform this analysis without a distance matrix, we use only the mean values of each variable selected. In this way, the variability within variables is not considered, as in the above solution. But we recognize that for some purpose it could be useful to have a plot with raw variables as axis as provided here.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/kmeans_gcms.html">kmeans_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; $suggested_gcms</span></span>
<span><span class="co">#&gt; [1] "ip" "ac" "uk"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $kmeans_plot</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-14-1.png" width="100%"></p>
<p>We can also obtain clusters through hierarchical clustering. In this case, however, the function doesn’t suggest any GCM. It is up to the user to define which GCMs are most suitable in this case. Hierarchical clustering is useful to visually inform the relationship between groups and could also be used to choose a number of clusters to build (together with metrics in the next section).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/hclust_gcms.html">hclust_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-15-1.png" width="100%"></p>
<p>In this function we also provide a <code>n</code> argument to inform the amount of data to be used in the clustering. This proved valuable when using high resolution data.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/hclust_gcms.html">hclust_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, k <span class="op">=</span> <span class="fl">3</span>, n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-16-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="number-of-clusters">Number of Clusters<a class="anchor" aria-label="anchor" href="#number-of-clusters"></a>
</h4>
<p>But how many clusters are good? There is three metrics implemented to understand that. All of them are a way to see the minimum amount of GCMs that are needed to encompass the variability in the whole set of GCMs. The three methods are implemented in the same function by adjusting the <code>method</code> argument. Within-cluster sum of squares (wss) calculates the internal variability within clusters. Our goal here is to search for the minimum amount of clusters that has the minimum amount of variability. This is shown in the graph were the line changes abruptly its direction (Number of clusters k = 3). As in the previous function, this function provides a <code>n</code> argument to inform the amount of data to be used in the clustering. Finally, one can also indicate the method to build clusters with the argument <code>clusters</code>. Available methods are ‘kmeans’ (standard) and ‘hclust’.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/optk_gcms.html">optk_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, cluster <span class="op">=</span> <span class="st">"kmeans"</span>, method <span class="op">=</span> <span class="st">"wss"</span>, n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-17-1.png" width="100%"></p>
<p>The Average Silhouette Width method, measures the mean distance from all individuals to the centroid of their own clusters, while comparing to other clusters. This is sometimes also referred as a metric of cluster quality (the higher the better). A number of clusters is the best when the distance from individuals within the cluster to its centroid is lower than the distance from individuals to other clusters centroid (maximizing the average silhouette width). In this method, the best number of clusters is marked with a dashed line (2 clusters).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/optk_gcms.html">optk_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, cluster <span class="op">=</span> <span class="st">"kmeans"</span>, method <span class="op">=</span> <span class="st">"silhouette"</span>, n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-18-1.png" width="100%"></p>
<p>Our last method is the Gap Statistics. As in the previous method, here the optimum number of clusters is showed with a dashed line (1 cluster). This method compares the variation within clusters with a set of null clusters build through Monte Carlo (“bootstrap”) sampling. Because of that, the gap statistics can take a longer time to run when compared to previous methods described here. Moreover, some parameters can be changed to improve the Monte Carlo process, such as: <code>nstart</code>, <code>K.max</code> and <code>B</code>, where <code>nstart</code> is the initial number of arrangements to be compared, <code>K.max</code> is the maximum number of clusters to be created and B is the number of bootstrap permutations.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/optk_gcms.html">optk_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, cluster <span class="op">=</span> <span class="st">"kmeans"</span>, method <span class="op">=</span> <span class="st">"gap_stat"</span>, n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: did not converge in 10 iterations</span></span>
<span></span>
<span><span class="co">#&gt; Warning: did not converge in 10 iterations</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-19-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="monte-carlo-permutations">Monte Carlo permutations<a class="anchor" aria-label="anchor" href="#monte-carlo-permutations"></a>
</h4>
<p>An alternative way to analyse if the mean distance between GCMs is similar to the mean distance between all GCMs is to use the <code>montecarlo_gcms</code> function. This function will build a distance matrix (using <code>method</code> argument) and plot the mean distance between all GCMs as a blue line. Afterwards, it will run a Monte Carlo permutation to randomly choose a group size ranging from [2] and [total number of GCMs - 1] and randomly choose a subset of GCMs with that group size. The mean distance between the random set is obtained and ploted in a violin plot. Finally, the function accesses the mean distance between selected GCMs using the kmeans function in all possible values of <code>k</code> and plots it in red.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/montecarlo_gcms.html">montecarlo_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, perm <span class="op">=</span> <span class="fl">10000</span>, method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $montecarlo_plot</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-20-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="the-environment-covered-by-gcms-selection">The environment covered by GCMs selection<a class="anchor" aria-label="anchor" href="#the-environment-covered-by-gcms-selection"></a>
</h4>
<p>We also included in this package a function called <code>env_gcms</code>, which is able to project GCMs in the environmental space. With that, researchers are able to see the coverage of GCMs when comparing to all GCMs. It is also possible to see the density of GCMs using the <code>highlight=sum</code> as argument.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/env_gcms.html">env_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, highlight <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">suggested_gcms</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-21-1.png" width="100%"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/env_gcms.html">env_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, highlight <span class="op">=</span> <span class="st">"sum"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-22-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="wrapping-up">Wrapping Up<a class="anchor" aria-label="anchor" href="#wrapping-up"></a>
</h4>
<p>From our analysis, we can infer that something between two and three clusters is enough to inform regarding the environmental variation from given GCMs. In this way, if we use GCMs CNRM-CM6-1 (cn), FIO-ESM-2-0 (fi) and MPI-ESM1-2-HR (mp) to project our models into future scenarios we would be able to inform a decent variation in our projections.</p>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing chooseGCM</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Luíz Fernando Esser <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Luíz Fernando Esser.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
